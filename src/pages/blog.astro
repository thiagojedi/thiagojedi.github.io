---
import BaseHead from '../components/BaseHead.astro';
import BlogList from '../components/blog-list.jsx';
import Header from '../components/header.astro';
import Sidebar from '../components/sidebar.astro';
import Footer from '../components/Footer.astro';

import { sortByDate } from '../helpers/date';

// Use Astro.glob() to fetch all posts, and then sort them by date.
const allPosts: Post[] = await Astro.glob('./blog/*.{md,mdx}');

const drafts = allPosts.filter((post) => post.frontmatter.draft);

const normalPosts = allPosts
  .filter((post) => !post.frontmatter.draft)
  .sort(sortByDate((x) => x.frontmatter.pubDate!));

const posts = [...drafts, ...normalPosts];
---

<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <BaseHead />
  </head>

  <body>
    <Header />

    <nav aria-label="breadcrumb">
      <ul>
        <li>
          <a href="/">PÃ¡gina Inicial</a>
        </li>
        <li aria-current="page">Blog</li>
      </ul>
    </nav>

    <main>
      <div>
        <BlogList posts={posts} />
      </div>

      <aside>
        <Sidebar />
      </aside>
    </main>
    <footer>
      <Footer />
    </footer>
  </body>
</html>
